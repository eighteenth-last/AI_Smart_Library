# AI 回复格式化示例

## 📝 格式化规则

为了让 AI 回复更加清晰、重点突出，系统支持以下格式化标记：

### 1. **粗体** - 使用 `**文本**`

**用途**：突出重点信息

**示例**：
```
**刘慈欣**是中国著名科幻作家
```

**渲染效果**：**刘慈欣**是中国著名科幻作家（紫色加粗）

---

### 2. 《书名》 - 使用 `《书名》`

**用途**：标识书籍名称

**示例**：
```
推荐《三体》系列
```

**渲染效果**：推荐**《三体》**系列（绿色背景高亮）

---

### 3. 数字列表 - 使用 `1. 内容`

**用途**：列举多个要点

**示例**：
```
1. 《三体》- 刘慈欣的经典作品
2. 《流浪地球》- 硬科幻代表作
3. 《球状闪电》- 探讨宏原子现象
```

**渲染效果**：
- 每个列表项有紫色圆形数字标签
- 带有左侧紫色边框的卡片样式
- 鼠标悬停有动画效果

---

### 4. 【标签】 - 使用 `【内容】`

**用途**：分类或强调重要部分

**示例**：
```
【科幻推荐】
【重要提示】
【借阅规则】
```

**渲染效果**：渐变紫色标签，带阴影

---

### 5. （来源信息） - 使用 `（内容）`

**用途**：标注来源或补充说明

**示例**：
```
《三体》系列（来自参考资料1）
```

**渲染效果**：灰色斜体小字

---

## 🎨 完整示例

### 输入文本（AI 生成）

```
【推荐书籍】

根据知识库信息，为您推荐以下科幻小说：

1. **《三体》系列** - 刘慈欣的经典作品，深入探讨宇宙文明和人类命运（来自参考资料1）
2. **《流浪地球》** - 优秀的硬科幻作品，充满想象力和科学严谨性（来自参考资料2）
3. **《球状闪电》** - 探讨宏原子现象，情节引人入胜

【借阅提示】

以上图书均可通过图书馆系统借阅，借阅期限为**30天**。
```

### 渲染效果

**【推荐书籍】**（紫色渐变标签）

根据知识库信息，为您推荐以下科幻小说：

**1.** **《三体》系列** - 刘慈欣的经典作品，深入探讨宇宙文明和人类命运 *（来自参考资料1）*
- 数字 1 是紫色圆形标签
- "《三体》系列" 是绿色高亮
- "来自参考资料1" 是灰色斜体

**2.** **《流浪地球》** - 优秀的硬科幻作品，充满想象力和科学严谨性 *（来自参考资料2）*

**3.** **《球状闪电》** - 探讨宏原子现象，情节引人入胜

**【借阅提示】**（紫色渐变标签）

以上图书均可通过图书馆系统借阅，借阅期限为**30天**。

---

## 🔧 Prompt 模板配置

### 知识库问答 Prompt

在 `RagPromptTemplate.buildKnowledgeBasePrompt()` 中已配置：

```
【回答要求】
1. 请基于上述参考知识库的内容准确回答用户问题
2. 如果知识库内容与问题相关，优先使用知识库信息
3. 如果知识库内容不够完整，可以适当补充你的知识，但要说明
4. 保持回答简洁、准确、友好
5. 如果知识库完全无法回答问题，请诚实说明并提供你能提供的帮助
6. **使用数字列表格式**，如：1. 第一点  2. 第二点
7. **书名请用《》括起来**，如：《三体》
8. **重要内容用**加粗**，如：**重点信息**
9. **分段分类**，使用【标签】分隔不同部分
```

### 图书推荐 Prompt

在 `RagPromptTemplate.buildBookRecommendPrompt()` 中已配置：

```
【推荐要求】
1. 基于参考案例和用户偏好给出个性化推荐
2. 推荐 3-5 本图书
3. 说明推荐理由
4. 如果有具体书籍信息，请包含书名和作者
5. **使用数字列表格式**，如：1. 《书名》 - 作者
6. **书名用《》括起来**
7. **重点信息加粗**，如：**经典作品**
8. **使用【标签】分类**，如：【科幻类】【悬疑类】
```

---

## 📊 样式定义

### CSS 样式（已在 Home/index.vue 中实现）

```css
/* 粗体高亮 */
.highlight-text {
  color: #667eea;
  font-weight: 600;
  font-size: 15px;
}

/* 书名高亮 */
.book-title {
  color: #18a058;
  font-weight: 600;
  background: linear-gradient(135deg, rgba(24, 160, 88, 0.1) 0%, rgba(24, 160, 88, 0.05) 100%);
  padding: 2px 6px;
  border-radius: 4px;
}

/* 来源信息 */
.source-info {
  color: #999;
  font-size: 12px;
  font-style: italic;
}

/* 标签样式 */
.section-tag {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 4px 12px;
  border-radius: 6px;
  font-weight: 600;
  font-size: 14px;
  margin: 8px 0;
  box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
}

/* 列表项 */
.list-item {
  display: flex;
  align-items: flex-start;
  margin: 8px 0;
  padding: 8px 12px;
  background: rgba(102, 126, 234, 0.05);
  border-radius: 8px;
  border-left: 3px solid #667eea;
}

/* 列表数字 */
.list-number {
  min-width: 24px;
  height: 24px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  font-weight: 600;
  font-size: 13px;
  border-radius: 50%;
  margin-right: 10px;
}
```

---

## 🧪 测试用例

### 测试 1：科幻小说推荐

**输入**：
```
推荐科幻小说
```

**期望输出**：
```
【科幻小说推荐】

根据知识库信息，为您推荐以下科幻小说：

1. **《三体》系列** - 刘慈欣的经典作品，深入探讨宇宙文明和人类命运
2. **《流浪地球》** - 优秀的硬科幻作品，充满想象力和科学严谨性

【推荐理由】

这些作品都是**中国科幻文学的代表作**，具有很高的文学价值和科学性。
```

### 测试 2：借阅规则

**输入**：
```
借阅规则是什么
```

**期望输出**：
```
【图书借阅规则】

1. 每位读者最多可同时借阅**5本图书**
2. 借阅期限为**30天**
3. 可续借**一次**
4. 逾期将产生**滞纳金**

【温馨提示】

请及时归还图书，避免产生逾期费用。
```

---

## 🎯 最佳实践

### ✅ 推荐做法

1. **结构化回答**：使用【标签】分隔不同部分
2. **列表清晰**：重要信息用数字列表
3. **突出重点**：关键信息用**加粗**
4. **书名规范**：所有书名用《》
5. **来源标注**：引用知识库时注明来源

### ❌ 避免做法

1. 不要使用纯文本大段回复
2. 不要混用不同格式标记
3. 不要过度使用加粗（保持重点突出）
4. 不要忘记标注书名

---

## 📚 相关文档

- [RAG 功能测试文档](./RAG_功能测试文档.md)
- [Embedding API 测试文档](./EMBEDDING_API_TEST.md)
- [后端开发进度文档](./后端开发进度文档.md)

---

**更新时间**：2025-11-29  
**版本**：v1.0
